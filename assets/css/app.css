:root{--bg:#0f172a;--panel:#111827;--fg:#e5e7eb;--muted:#94a3b8;--accent:#7c3aed;--ok:#10b981;--warn:#f59e0b;--danger:#ef4444;--card:#0b1220}
*{box-sizing:border-box;margin:0;padding:0}
body{font:14px/1.5 system-ui,-apple-system,Segoe UI,Roboto;background:var(--bg);color:var(--fg);min-height:100vh}
.app{display:flex;min-height:100vh}
aside{width:220px;background:#0b1220;border-right:1px solid #1f2937;padding:20px;flex-shrink:0}
.logo{display:flex;align-items:center;gap:10px;font-weight:700;font-size:18px;margin-bottom:24px}
.nav a{display:block;padding:12px 16px;border-radius:10px;color:var(--fg);text-decoration:none;margin:6px 0;background:#121a2e;transition:all .2s}
.nav a:hover{background:#1e293b;transform:translateX(4px)}
.nav a.active{background:var(--accent);color:#fff}
main{flex:1;padding:24px 32px;overflow-y:auto}

/* cards & stats */
.cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin:20px 0}
.card{background:var(--panel);border:1px solid #1f2937;border-radius:14px;padding:20px;margin-bottom:20px}
.card h3{margin-bottom:16px;color:var(--accent)}
.cards.stats .stat-label{color:var(--muted);font-size:12px}
.cards.stats .stat-number{font-size:24px;font-weight:700;margin-top:6px}

/* uploader */
.drop{border:2px dashed #374151;border-radius:12px;min-height:180px;display:flex;align-items:center;justify-content:center;margin:16px 0;color:var(--muted);cursor:pointer;transition:all .3s}
.drop:hover{border-color:var(--accent);background:rgba(124,58,237,.05)}

/* buttons */
.btn{background:var(--accent);border:none;color:#fff;padding:12px 20px;border-radius:10px;cursor:pointer;font-size:14px;font-weight:600;transition:all .2s}
.btn:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(124,58,237,.4)}
.btn.secondary{background:#374151}
.btn.warn{background:var(--warn)}
.btn.del{background:var(--danger);padding:8px 14px;font-size:13px}
.btn.small{padding:6px 12px;font-size:12px}
.btn.icon{padding:8px 12px;font-size:14px}
.btn.success{background:#10b981}
.btn.icon-only{padding:8px 10px;border-radius:10px;min-width:40px}

/* banners & misc */
.banner{background:#1f2937;border:1px solid #374151;border-left:4px solid var(--warn);padding:16px;border-radius:10px;color:#fbbf24;margin:20px 0;cursor:pointer;transition:all .2s}
.banner:hover{background:#252f3f;transform:translateX(4px)}
.ads{min-height:70px;background:linear-gradient(135deg,#1f2937,#0b1220);border:1px dashed #374151;border-radius:12px;display:flex;align-items:center;justify-content:center;color:#64748b;font-size:13px;margin:20px 0}
.hidden{display:none!important}

/* auth */
.auth-container{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#0f172a,#1e293b);padding:20px}
.auth-box{background:#0b1220;padding:40px;border-radius:16px;border:1px solid #1f2937;box-shadow:0 20px 60px rgba(0,0,0,.5);max-width:440px;width:100%}
.auth-box h1{font-size:28px;margin-bottom:8px;background:linear-gradient(135deg,#7c3aed,#a78bfa);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.auth-box p{color:var(--muted);margin-bottom:32px;font-size:14px}

/* forms */
.form-group{margin-bottom:20px}
.form-group label{display:block;margin-bottom:8px;font-weight:500;font-size:13px;color:var(--muted)}
input,select,textarea{width:100%;padding:12px 16px;border-radius:10px;border:1px solid #374151;background:#0b1220;color:#e5e7eb;font-size:14px;transition:border .2s;font-family:inherit}
input:focus,select:focus,textarea:focus{outline:none;border-color:var(--accent)}
input::placeholder,textarea::placeholder{color:#4b5563}
textarea{resize:vertical;min-height:80px}
.btn-group{display:flex;gap:12px;margin-top:24px}
.btn-group .btn{flex:1}
.link-btn{background:none;border:none;color:var(--accent);cursor:pointer;text-decoration:underline;font-size:13px;margin-top:16px;display:inline-block}
.link-btn:hover{color:#a78bfa}
.error{color:var(--danger);font-size:13px;margin-top:8px}
.success{color:var(--ok);font-size:13px;margin-top:8px}

/* tables */
table{width:100%;border-collapse:collapse;margin-top:16px}
th,td{border-bottom:1px solid #1f2937;padding:12px 8px;text-align:left}
th{color:var(--muted);font-weight:600;font-size:12px;text-transform:uppercase}
h1{margin-bottom:8px}

/* modal */
.modal{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;z-index:1000;padding:20px}
.modal-content{background:#0b1220;padding:32px;border-radius:16px;border:1px solid #1f2937;max-width:700px;width:100%;max-height:90vh;overflow-y:auto}

/* misc */
.badge-pro{background:linear-gradient(135deg,#f59e0b,#d97706);color:#fff;padding:4px 12px;border-radius:6px;font-size:11px;font-weight:700;display:inline-block;margin-left:8px}
.loader{display:inline-block;width:14px;height:14px;border:2px solid #374151;border-top-color:#fff;border-radius:50%;animation:spin 0.6s linear infinite;vertical-align:middle}
@keyframes spin{to{transform:rotate(360deg)}}
.category-tag{background:#0b1220;border:1px solid #374151;padding:6px 12px;border-radius:8px;display:inline-flex;align-items:center;gap:8px;font-size:13px;margin:4px}
.category-tag button{background:none;border:none;color:var(--danger);cursor:pointer;padding:0;font-size:14px}
.organize-item{background:#1f2937;padding:12px;border-radius:8px;margin:8px 0;display:flex;align-items:center;gap:12px}
.organize-item .filename{flex:1;font-size:13px;color:var(--fg)}
.organize-item select{width:200px;font-size:13px;padding:8px}
.filter-bar{background:#1f2937;padding:12px 16px;border-radius:10px;margin:16px 0;display:flex;gap:12px;align-items:center}
.filter-bar label{font-size:13px;color:var(--muted)}
.filter-bar select{width:auto;min-width:200px;padding:8px 12px;font-size:13px}
.category-select-cell{min-width:150px}
.category-select-cell select{width:100%;padding:6px 10px;font-size:13px}
.new-category-box{background:#0b1220;border:2px dashed #7c3aed;padding:16px;border-radius:10px;margin:16px 0}
.new-category-box h4{color:var(--accent);margin-bottom:12px;font-size:14px}

/* chat */
.chat-message{padding:16px;border-radius:10px;margin-bottom:16px;border-left:4px solid var(--accent)}
.chat-message.docs{background:#1f2937;border-left-color:#7c3aed}
.chat-message.ai{background:#0b1220;border-left-color:#10b981}
.chat-controls{display:flex;gap:8px;align-items:center;margin-top:12px;flex-wrap:wrap}
.chat-controls select{width:auto;padding:6px 10px;font-size:12px;max-width:200px}
.context-box{background:#1e293b;border:2px solid #7c3aed;border-radius:10px;padding:16px;margin-bottom:16px;position:relative}
.context-box textarea{min-height:100px;background:#0b1220;border-color:#374151}
.context-box .remove-context{position:absolute;top:8px;right:8px;background:var(--danger);color:#fff;border:none;border-radius:6px;padding:4px 8px;cursor:pointer;font-size:12px}
.settings-row{display:flex;gap:12px;align-items:center;margin-bottom:12px;background:#1f2937;padding:12px;border-radius:8px;flex-wrap:wrap}
.settings-row label{font-size:13px;color:var(--muted);white-space:nowrap}
.settings-row--compact{padding:8px;gap:10px}

/* composer e azioni chat */
.compose{display:flex;gap:8px;align-items:center}
.compose input{flex:1}
.chat-docs-actions{display:flex;align-items:center;gap:8px;margin-top:8px}
.pill{background:#121a2e;border:1px solid #374151;border-radius:999px;padding:6px 10px;font-size:12px;display:inline-flex;align-items:center;gap:6px}

/* ====== MOBILE NAV & DRAWER (BASE HIDDEN ON DESKTOP) ====== */
.topbar{display:none}
.mobile-nav{display:none}
.scrim{display:none}

/* ====== RESPONSIVE (â‰¤ 768px) ====== */
@media (max-width: 768px) {
  /* layout generale */
  .app{flex-direction: column}
  main{padding:16px 16px 80px}

  /* sidebar -> drawer */
  aside{
    position: fixed; top:0; left:0; bottom:0; width:260px;
    z-index:1001; transform: translateX(-100%); transition: transform .25s ease;
  }
  body.menu-open aside{ transform: translateX(0) }
  .scrim{display:none; position:fixed; inset:0; background:rgba(0,0,0,.5); z-index:1000}
  body.menu-open .scrim{display:block}

  /* topbar */
  .topbar{display:flex; align-items:center; gap:12px; background:#0b1220; border-bottom:1px solid #1f2937; padding:12px 16px; position:sticky; top:0; z-index:999}
  .topbar .menu-btn{background:none; border:1px solid #374151; border-radius:10px; padding:8px 10px; color:var(--fg)}

  /* bottom tab bar */
  .mobile-nav{display:flex; position:fixed; bottom:0; left:0; right:0; background:#0b1220; border-top:1px solid #1f2937; padding:8px calc(8px + env(safe-area-inset-right)) calc(8px + env(safe-area-inset-bottom)) calc(8px + env(safe-area-inset-left)); gap:8px; z-index:999}
  .mobile-nav a{flex:1; text-align:center; text-decoration:none; color:var(--fg); background:#121a2e; padding:8px 6px; border-radius:12px; font-size:12px; line-height:1.2; display:flex; flex-direction:column; align-items:center; justify-content:center}
  .mobile-nav a.active{background:var(--accent); color:#fff}

  /* tipografia e spaziature */
  body{font-size:15px}
  h1{font-size:20px}
  .card{padding:16px}
  .cards{grid-template-columns:1fr; gap:12px}
  .drop{min-height:120px}
  .filter-bar{flex-direction:column; align-items:stretch}
  .settings-row{gap:8px}

  /* compose in 2 righe strette quando serve */
  .chat-docs-actions{justify-content:space-between}
  .compose .btn{padding:8px 10px}

  /* tabelle scrollabili */
  table{display:block; max-width:100%; overflow-x:auto; white-space:nowrap}
}

/* ====================================================================== */
/* CALENDARIO MOBILE IBRIDO V2 - FIX LAYOUT */
/* Sostituisci completamente il blocco calendario in app.css */
/* ====================================================================== */

/* === Mobile Calendar Container === */
.mobile-calendar {
  display: flex !important;
  flex-direction: column !important;
  gap: 16px !important;
  padding: 8px !important;
  width: 100% !important;
}

/* === Mini Month Grid === */
.mini-month-grid {
  background: var(--panel) !important;
  border-radius: 12px !important;
  padding: 12px !important;
  border: 1px solid #374151 !important;
  width: 100% !important;
  box-sizing: border-box !important;
}

.mini-month-header {
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  margin-bottom: 16px !important;
  padding: 0 4px !important;
  width: 100% !important;
}

.mini-month-header h3 {
  font-size: 16px !important;
  font-weight: 600 !important;
  color: var(--fg) !important;
  margin: 0 !important;
  flex: 1 !important;
  text-align: center !important;
}

.month-nav-btn {
  background: #1f2937 !important;
  border: 1px solid #374151 !important;
  color: var(--fg) !important;
  width: 36px !important;
  height: 36px !important;
  border-radius: 8px !important;
  font-size: 20px !important;
  cursor: pointer !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  flex-shrink: 0 !important;
}

/* Headers giorni settimana - GRID FORZATO */
.mini-month-days-header {
  display: grid !important;
  grid-template-columns: repeat(7, 1fr) !important;
  gap: 4px !important;
  margin-bottom: 8px !important;
  width: 100% !important;
}

.mini-month-days-header div {
  font-size: 11px !important;
  font-weight: 600 !important;
  color: var(--muted) !important;
  text-transform: uppercase !important;
  padding: 4px 0 !important;
  text-align: center !important;
  display: block !important;
}

/* Griglia giorni - GRID FORZATO */
.mini-month-days {
  display: grid !important;
  grid-template-columns: repeat(7, 1fr) !important;
  gap: 4px !important;
  width: 100% !important;
}

.mini-day {
  aspect-ratio: 1 / 1 !important;
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
  justify-content: center !important;
  border-radius: 8px !important;
  position: relative !important;
  cursor: pointer !important;
  background: #0b1220 !important;
  border: 1px solid #374151 !important;
  min-height: 42px !important;
  padding: 4px !important;
  box-sizing: border-box !important;
}

.mini-day.empty {
  cursor: default !important;
  opacity: 0 !important;
  visibility: hidden !important;
}

.mini-day .day-number {
  font-size: 14px !important;
  font-weight: 500 !important;
  color: var(--fg) !important;
  margin-bottom: 2px !important;
  display: block !important;
  line-height: 1 !important;
}

.mini-day.today {
  background: rgba(124, 58, 237, 0.2) !important;
  border-color: var(--accent) !important;
}

.mini-day.today .day-number {
  background: var(--accent) !important;
  color: white !important;
  width: 26px !important;
  height: 26px !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  border-radius: 50% !important;
  font-weight: 600 !important;
}

.mini-day.selected {
  background: #1f2937 !important;
  border: 2px solid var(--accent) !important;
}

.mini-day.has-events {
  border-color: var(--accent) !important;
}

.mini-day:not(.empty):active {
  transform: scale(0.95) !important;
}

/* Pallini eventi */
.event-dots {
  position: absolute !important;
  bottom: 4px !important;
  font-size: 6px !important;
  color: var(--accent) !important;
  letter-spacing: 2px !important;
  line-height: 1 !important;
  display: block !important;
}

/* === Lista Eventi Giorno === */
.day-events-list {
  background: var(--panel) !important;
  border-radius: 12px !important;
  border: 1px solid #374151 !important;
  min-height: 300px !important;
  max-height: 500px !important;
  display: flex !important;
  flex-direction: column !important;
  width: 100% !important;
  box-sizing: border-box !important;
  overflow: hidden !important;
}

.day-events-header {
  padding: 16px !important;
  border-bottom: 1px solid #374151 !important;
  flex-shrink: 0 !important;
}

.day-events-header h3 {
  margin: 0 !important;
  font-size: 18px !important;
  font-weight: 600 !important;
  color: var(--fg) !important;
  text-transform: capitalize !important;
}

.day-events-content {
  flex: 1 !important;
  overflow-y: auto !important;
  padding: 8px !important;
  -webkit-overflow-scrolling: touch !important;
}

/* Evento singolo nella lista */
.event-item {
  display: flex !important;
  gap: 12px !important;
  padding: 12px !important;
  margin-bottom: 8px !important;
  background: #0b1220 !important;
  border-left: 4px solid var(--accent) !important;
  border-radius: 8px !important;
  cursor: pointer !important;
  width: 100% !important;
  box-sizing: border-box !important;
}

.event-item:active {
  transform: scale(0.98) !important;
  background: #1f2937 !important;
}

.event-time {
  font-size: 12px !important;
  font-weight: 600 !important;
  color: var(--accent) !important;
  min-width: 65px !important;
  flex-shrink: 0 !important;
  display: block !important;
}

.event-details {
  flex: 1 !important;
  min-width: 0 !important;
  display: flex !important;
  flex-direction: column !important;
  gap: 4px !important;
}

.event-title {
  font-size: 14px !important;
  font-weight: 600 !important;
  color: var(--fg) !important;
  display: block !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  white-space: nowrap !important;
}

.event-description {
  font-size: 12px !important;
  color: var(--muted) !important;
  display: block !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  white-space: nowrap !important;
}

/* Nessun evento */
.no-events {
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
  justify-content: center !important;
  padding: 48px 24px !important;
  color: var(--muted) !important;
  font-size: 14px !important;
  text-align: center !important;
}

/* Loading */
.loading {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  padding: 48px 24px !important;
  color: var(--muted) !important;
  font-size: 14px !important;
}

/* === RESPONSIVE === */

/* Desktop: nascondi mobile, mostra FullCalendar */
@media (min-width: 769px) {
  .mobile-calendar {
    display: none !important;
  }
}

/* Mobile: mostra mobile, nascondi FullCalendar */
@media (max-width: 768px) {
  /* Forza nascondere FullCalendar */
  .fc,
  .fc *,
  #cal > .fc {
    display: none !important;
    visibility: hidden !important;
    height: 0 !important;
    overflow: hidden !important;
  }

  /* Forza mostrare mobile calendar */
  .mobile-calendar,
  .mobile-calendar * {
    display: initial !important;
    visibility: visible !important;
  }

  .mobile-calendar {
    display: flex !important;
  }

  .mini-month-days-header,
  .mini-month-days {
    display: grid !important;
  }

  .day-events-list {
    display: flex !important;
  }

  .event-item {
    display: flex !important;
  }

  .event-details {
    display: flex !important;
  }

  .calendar-card {
    padding: 8px !important;
    margin: 0 0 16px 0 !important;
  }

  /* Ottimizza per schermi piccoli */
  .mini-day {
    min-height: 40px !important;
  }

  .mini-day .day-number {
    font-size: 13px !important;
  }

  .event-item {
    padding: 10px !important;
    gap: 10px !important;
  }

  .event-time {
    font-size: 11px !important;
    min-width: 60px !important;
  }

  .event-title {
    font-size: 13px !important;
  }

  .event-description {
    font-size: 11px !important;
  }
}

/* Extra small mobile */
@media (max-width: 400px) {
  .mini-month-header h3 {
    font-size: 14px !important;
  }

  .month-nav-btn {
    width: 32px !important;
    height: 32px !important;
    font-size: 18px !important;
  }

  .mini-day {
    min-height: 38px !important;
  }

  .mini-day .day-number {
    font-size: 12px !important;
  }

  .event-dots {
    font-size: 5px !important;
    letter-spacing: 1px !important;
  }
}

/* ====================================================================== */
/* FINE CALENDARIO MOBILE IBRIDO V2 */
/* ====================================================================== */

/* Chips tipo evento e promemoria */
.chip {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 5px 10px;
  border-radius: 16px;
  font-size: 13px;
  font-weight: 500;
  background: #334155;
  color: white;
}

.chip-x {
  border: none;
  background: transparent;
  color: #cbd5e1;
  cursor: pointer;
  font-weight: 700;
  padding: 0 0 0 4px;
  font-size: 14px;
}

.chip-x:hover {
  color: #ef4444;
}

@import url('assistant.css');
