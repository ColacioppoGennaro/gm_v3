:root{--bg:#0f172a;--panel:#111827;--fg:#e5e7eb;--muted:#94a3b8;--accent:#7c3aed;--ok:#10b981;--warn:#f59e0b;--danger:#ef4444;--card:#0b1220}
*{box-sizing:border-box;margin:0;padding:0}
body{font:14px/1.5 system-ui,-apple-system,Segoe UI,Roboto;background:var(--bg);color:var(--fg);min-height:100vh}
.app{display:flex;min-height:100vh}
aside{width:220px;background:#0b1220;border-right:1px solid #1f2937;padding:20px;flex-shrink:0}
.logo{display:flex;align-items:center;gap:10px;font-weight:700;font-size:18px;margin-bottom:24px}
.nav a{display:block;padding:12px 16px;border-radius:10px;color:var(--fg);text-decoration:none;margin:6px 0;background:#121a2e;transition:all .2s}
.nav a:hover{background:#1e293b;transform:translateX(4px)}
.nav a.active{background:var(--accent);color:#fff}
main{flex:1;padding:24px 32px;overflow-y:auto}

/* cards & stats */
.cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin:20px 0}
.card{background:var(--panel);border:1px solid #1f2937;border-radius:14px;padding:20px;margin-bottom:20px}
.card h3{margin-bottom:16px;color:var(--accent)}
.cards.stats .stat-label{color:var(--muted);font-size:12px}
.cards.stats .stat-number{font-size:24px;font-weight:700;margin-top:6px}

/* uploader */
.drop{border:2px dashed #374151;border-radius:12px;min-height:180px;display:flex;align-items:center;justify-content:center;margin:16px 0;color:var(--muted);cursor:pointer;transition:all .3s}
.drop:hover{border-color:var(--accent);background:rgba(124,58,237,.05)}

/* buttons */
.btn{background:var(--accent);border:none;color:#fff;padding:12px 20px;border-radius:10px;cursor:pointer;font-size:14px;font-weight:600;transition:all .2s}
.btn:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(124,58,237,.4)}
.btn.secondary{background:#374151}
.btn.warn{background:var(--warn)}
.btn.del{background:var(--danger);padding:8px 14px;font-size:13px}
.btn.small{padding:6px 12px;font-size:12px}
.btn.icon{padding:8px 12px;font-size:14px}
.btn.success{background:#10b981}
.btn.icon-only{padding:8px 10px;border-radius:10px;min-width:40px}

/* banners & misc */
.banner{background:#1f2937;border:1px solid #374151;border-left:4px solid var(--warn);padding:16px;border-radius:10px;color:#fbbf24;margin:20px 0;cursor:pointer;transition:all .2s}
.banner:hover{background:#252f3f;transform:translateX(4px)}
.ads{min-height:70px;background:linear-gradient(135deg,#1f2937,#0b1220);border:1px dashed #374151;border-radius:12px;display:flex;align-items:center;justify-content:center;color:#64748b;font-size:13px;margin:20px 0}
.hidden{display:none!important}

/* auth */
.auth-container{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#0f172a,#1e293b);padding:20px}
.auth-box{background:#0b1220;padding:40px;border-radius:16px;border:1px solid #1f2937;box-shadow:0 20px 60px rgba(0,0,0,.5);max-width:440px;width:100%}
.auth-box h1{font-size:28px;margin-bottom:8px;background:linear-gradient(135deg,#7c3aed,#a78bfa);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.auth-box p{color:var(--muted);margin-bottom:32px;font-size:14px}

/* forms */
.form-group{margin-bottom:20px}
.form-group label{display:block;margin-bottom:8px;font-weight:500;font-size:13px;color:var(--muted)}
input,select,textarea{width:100%;padding:12px 16px;border-radius:10px;border:1px solid #374151;background:#0b1220;color:#e5e7eb;font-size:14px;transition:border .2s;font-family:inherit}
input:focus,select:focus,textarea:focus{outline:none;border-color:var(--accent)}
input::placeholder,textarea::placeholder{color:#4b5563}
textarea{resize:vertical;min-height:80px}
.btn-group{display:flex;gap:12px;margin-top:24px}
.btn-group .btn{flex:1}
.link-btn{background:none;border:none;color:var(--accent);cursor:pointer;text-decoration:underline;font-size:13px;margin-top:16px;display:inline-block}
.link-btn:hover{color:#a78bfa}
.error{color:var(--danger);font-size:13px;margin-top:8px}
.success{color:var(--ok);font-size:13px;margin-top:8px}

/* tables */
table{width:100%;border-collapse:collapse;margin-top:16px}
th,td{border-bottom:1px solid #1f2937;padding:12px 8px;text-align:left}
th{color:var(--muted);font-weight:600;font-size:12px;text-transform:uppercase}
h1{margin-bottom:8px}

/* modal */
.modal{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;z-index:1000;padding:20px}
.modal-content{background:#0b1220;padding:32px;border-radius:16px;border:1px solid #1f2937;max-width:700px;width:100%;max-height:90vh;overflow-y:auto}

/* misc */
.badge-pro{background:linear-gradient(135deg,#f59e0b,#d97706);color:#fff;padding:4px 12px;border-radius:6px;font-size:11px;font-weight:700;display:inline-block;margin-left:8px}
.loader{display:inline-block;width:14px;height:14px;border:2px solid #374151;border-top-color:#fff;border-radius:50%;animation:spin 0.6s linear infinite;vertical-align:middle}
@keyframes spin{to{transform:rotate(360deg)}}
.category-tag{background:#0b1220;border:1px solid #374151;padding:6px 12px;border-radius:8px;display:inline-flex;align-items:center;gap:8px;font-size:13px;margin:4px}
.category-tag button{background:none;border:none;color:var(--danger);cursor:pointer;padding:0;font-size:14px}
.organize-item{background:#1f2937;padding:12px;border-radius:8px;margin:8px 0;display:flex;align-items:center;gap:12px}
.organize-item .filename{flex:1;font-size:13px;color:var(--fg)}
.organize-item select{width:200px;font-size:13px;padding:8px}
.filter-bar{background:#1f2937;padding:12px 16px;border-radius:10px;margin:16px 0;display:flex;gap:12px;align-items:center}
.filter-bar label{font-size:13px;color:var(--muted)}
.filter-bar select{width:auto;min-width:200px;padding:8px 12px;font-size:13px}
.category-select-cell{min-width:150px}
.category-select-cell select{width:100%;padding:6px 10px;font-size:13px}
.new-category-box{background:#0b1220;border:2px dashed #7c3aed;padding:16px;border-radius:10px;margin:16px 0}
.new-category-box h4{color:var(--accent);margin-bottom:12px;font-size:14px}

/* chat */
.chat-message{padding:16px;border-radius:10px;margin-bottom:16px;border-left:4px solid var(--accent)}
.chat-message.docs{background:#1f2937;border-left-color:#7c3aed}
.chat-message.ai{background:#0b1220;border-left-color:#10b981}
.chat-controls{display:flex;gap:8px;align-items:center;margin-top:12px;flex-wrap:wrap}
.chat-controls select{width:auto;padding:6px 10px;font-size:12px;max-width:200px}
.context-box{background:#1e293b;border:2px solid #7c3aed;border-radius:10px;padding:16px;margin-bottom:16px;position:relative}
.context-box textarea{min-height:100px;background:#0b1220;border-color:#374151}
.context-box .remove-context{position:absolute;top:8px;right:8px;background:var(--danger);color:#fff;border:none;border-radius:6px;padding:4px 8px;cursor:pointer;font-size:12px}
.settings-row{display:flex;gap:12px;align-items:center;margin-bottom:12px;background:#1f2937;padding:12px;border-radius:8px;flex-wrap:wrap}
.settings-row label{font-size:13px;color:var(--muted);white-space:nowrap}
.settings-row--compact{padding:8px;gap:10px}

/* composer e azioni chat */
.compose{display:flex;gap:8px;align-items:center}
.compose input{flex:1}
.chat-docs-actions{display:flex;align-items:center;gap:8px;margin-top:8px}
.pill{background:#121a2e;border:1px solid #374151;border-radius:999px;padding:6px 10px;font-size:12px;display:inline-flex;align-items:center;gap:6px}

/* ====== MOBILE NAV & DRAWER (BASE HIDDEN ON DESKTOP) ====== */
.topbar{display:none}
.mobile-nav{display:none}
.scrim{display:none}

/* ====== RESPONSIVE (≤ 768px) ====== */
@media (max-width: 768px) {
  /* layout generale */
  .app{flex-direction: column}
  main{padding:16px 16px 80px}

  /* sidebar -> drawer */
  aside{
    position: fixed; top:0; left:0; bottom:0; width:260px;
    z-index:1001; transform: translateX(-100%); transition: transform .25s ease;
  }
  body.menu-open aside{ transform: translateX(0) }
  .scrim{display:none; position:fixed; inset:0; background:rgba(0,0,0,.5); z-index:1000}
  body.menu-open .scrim{display:block}

  /* topbar */
  .topbar{display:flex; align-items:center; gap:12px; background:#0b1220; border-bottom:1px solid #1f2937; padding:12px 16px; position:sticky; top:0; z-index:999}
  .topbar .menu-btn{background:none; border:1px solid #374151; border-radius:10px; padding:8px 10px; color:var(--fg)}

  /* bottom tab bar */
  .mobile-nav{display:flex; position:fixed; bottom:0; left:0; right:0; background:#0b1220; border-top:1px solid #1f2937; padding:8px calc(8px + env(safe-area-inset-right)) calc(8px + env(safe-area-inset-bottom)) calc(8px + env(safe-area-inset-left)); gap:8px; z-index:999}
  .mobile-nav a{flex:1; text-align:center; text-decoration:none; color:var(--fg); background:#121a2e; padding:8px 6px; border-radius:12px; font-size:12px; line-height:1.2; display:flex; flex-direction:column; align-items:center; justify-content:center}
  .mobile-nav a.active{background:var(--accent); color:#fff}

  /* tipografia e spaziature */
  body{font-size:15px}
  h1{font-size:20px}
  .card{padding:16px}
  .cards{grid-template-columns:1fr; gap:12px}
  .drop{min-height:120px}
  .filter-bar{flex-direction:column; align-items:stretch}
  .settings-row{gap:8px}

  /* compose in 2 righe strette quando serve */
  .chat-docs-actions{justify-content:space-between}
  .compose .btn{padding:8px 10px}

  /* tabelle scrollabili */
  table{display:block; max-width:100%; overflow-x:auto; white-space:nowrap}
}

/* ===== Calendar layout ===== */

.calendar-card { padding: 0; overflow: hidden; }
.calendar-card-warning { background: #1f2937; border-left: 4px solid var(--warn); }

.calendar-toolbar {
  display: flex; gap: 10px; justify-content: flex-end;
  padding: 10px 12px; border-bottom: 1px solid #1f2937; background: #0b1220;
}

.calendar-root { padding: 10px; }

/* Contenitore: evita overflow orizzontale, usa tutta la larghezza */
#cal, .calendar-root, .calendar-card { width: 100%; }

/* FullCalendar: alleggerisci su mobile, evita “schiacciamento” */
.fc { --fc-border-color: #1f2937; --fc-page-bg-color: transparent; }
.fc .fc-scrollgrid,
.fc .fc-view-harness { border-color: #1f2937; }
.fc .fc-toolbar.fc-header-toolbar { gap: 8px; flex-wrap: wrap; padding: 8px 10px; }
.fc .fc-toolbar-title { font-size: 1.1rem; }

/* Eventi più leggibili */
.fc .fc-daygrid-day-number { padding: 4px; }
.fc .fc-daygrid-event, .fc .fc-timegrid-event { font-size: 0.95rem; line-height: 1.2; }
.fc .fc-daygrid-more-link { font-size: 0.85rem; }

/* TimeGrid: righe ariose ma compatte */
.fc .fc-timegrid-slot { height: 2.3em; }
.fc .fc-timegrid-axis-cushion, .fc .fc-timegrid-slot-label-cushion { padding: 4px 6px; }

/* ===== Responsive (≤ 700px) ===== */
@media (max-width: 700px) {
  .calendar-card { border-radius: 12px; }
  .calendar-root { padding: 8px; }
  .fc .fc-toolbar-title { font-size: 1rem; }
  .fc .fc-button { padding: 6px 10px; font-size: 0.9rem; }
  .fc .fc-col-header-cell-cushion { padding: 6px 0; font-size: 0.85rem; }
  .fc .fc-daygrid-day-number { font-size: 0.85rem; }
  .fc .fc-daygrid-event, .fc .fc-timegrid-event { font-size: 0.9rem; }
  .fc .fc-timegrid-slot { height: 2.1em; }
  body, html { overflow-x: hidden; }
}
